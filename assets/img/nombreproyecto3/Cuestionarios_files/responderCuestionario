(function(n,t){var u,r,f,i;n.stopInterval=function(){clearInterval(u);clearInterval(f)};n.InitPopover=function(){t('*[data-toggle="popover"]').popover({html:!0,content:function(){var n=t("#"+t(this).data("id"));return n.html()}})};t("#wizard").on("click","a.pagina",function(n){n.preventDefault();var i=t(this).data("pag");t("#tipo").val("P");t("#pagina").val(i);t("#formWizard").submit()});n.setAplentId=function(n){r=n};n.InitTime=function(){var n=t("#cue_tiempo_disponible").val(),r=t("#cueresper_fecha_inicio").val(),c=!1,l=!1,a=!1,v=!1,h,y,p,w;n&&(h=function(){var e=s(n,r);if(e.minutes()>0&&e.seconds()>0)return i=e,!1;clearInterval(u);clearInterval(f);t("#tipo").val()!=="R"&&t("#guardar").val(!0);t("#tipo").val("S");t("#direccion").val("1");t("#timeOut").val(!0);t("#formWizard").submit()},y=function(i,u,f){var o=(u<10?"0":"")+u+":"+(f<10?"0":"")+f;i===0&&f===0?u!==15||v?u!==10||a?u!==5||l?u!==1||c?u===0&&(h(),e(i,u,f,r,n,"3"),o="00:00"):(jack.showMessage("info","Te quedan 1 minuto para terminar el cuestionario"),c=!0):(jack.showMessage("info","Te quedan 5 minutos para terminar el cuestionario"),l=!0):(jack.showMessage("info","Te quedan 10 minutos para terminar el cuestionario"),a=!0):(jack.showMessage("info","Te quedan 15 minutos para terminar el cuestionario"),v=!0):(i<0||u<0||f<0)&&(h(),e(i,u,f,r,n,"2"),o="00:00");i>0?t("#clock").html(i+":"+o):t("#clock").html(o)},i=s(n,r),u=setInterval(function(){i.subtract(1,"s");y(i.hours(),i.minutes(),i.seconds())},1e3),f=setInterval(function(){o(!0)},5e4),console.log("Entra",t("#checkDuplicate").val()),t("#checkDuplicate").val()===""?(t("#checkDuplicate").val("already loaded"),p=window.attachEvent||window.addEventListener,w=window.attachEvent?"onbeforeunload":"beforeunload",p(w,function(){o(!1)})):(t(document).scrollTop(0),location.reload()),console.log("Sale",t("#checkDuplicate").val()),i.seconds()<0&&(h(),e(i.hours(),i.minutes(),i.seconds(),r,n,"1")))};var e=function(n,i,u,f,e,o){var h=JSON.stringify({horasRestantes:n,minutosRestantes:i,segundosRestantes:u,fechaInicio:f,tiempoMaximo:e,ubicacion:o}),s="/educacionvirtual/cuestionarios/ingresarlogtimeout";r&&(s+="?aplentId="+r);t.ajax({url:s,data:h,type:"Post",dataType:"json",contentType:"application/json; charset=UTF-8"})},o=function(n){var i="/educacionvirtual/Cuestionarios/UpdateToken";r&&(i+="?aplentId="+r);t.ajax({url:i,data:JSON.stringify({consecutivo:t("#cueresper_consecutivoP").val(),val:n,ignoreSpamAttribute:!0}),type:"Post",dataType:"json",contentType:"application/json; charset=UTF-8",success:function(){}})},s=function(n,i){var u,f="/educacionvirtual/Cuestionarios/TiempoRestante";return r&&(f+="?aplentId="+r),t.ajax({url:f,data:JSON.stringify({tiempoMaximo:n,fechaInicio:i}),type:"Post",dataType:"json",async:!1,contentType:"application/json; charset=UTF-8",success:function(n){u=n.seguntosTotales}}),moment.duration({seconds:u})}})(window.rescue=window.rescue||{},jQuery)